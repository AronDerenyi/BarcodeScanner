<!DOCTYPE html>
<html lang="en">

	<head>

		<meta charset="utf-8">

		<title>Made by Aron</title>

	</head>

	<body style="background: black;">

		<video id="video" autoplay style="
			width: 100vw;
			height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
			background: black;"></video>

		<div style="
			width: 100vw;
			height: 0;
			position: fixed;
			top: 50%;
			left: 0;
			border: 1px solid rgba(255, 0, 0, 1);
			mix-blend-mode: color"></div>

		<canvas id="canvas" style="
			position: fixed;
			top: 0;
			left: 0;"></canvas>

	</body>

</html>

<script>
	var video = document.getElementById("video");
	//var canvas = document.createElement("canvas");
	var canvas = document.getElementById("canvas");

	if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
		navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
			video.src = window.URL.createObjectURL(stream);
			video.play();
			loop();
		});
	}

	function loop() {
		if (video.videoWidth > 0 && video.videoHeight > 0) parse();
		setInterval(loop, 200);
	}

	function parse() {
		var width = video.videoWidth;
		var height = video.videoHeight;
		canvas.width = width;
		canvas.height = height;

		var context = canvas.getContext("2d");
		context.drawImage(video, 0, 0, width, height);

		var row = height / 2;
		var data = context.getImageData(0, 0, width, height).data.slice(row * width * 3, width * 3);
		console.log(data);

		for (var i = 0; i < width; i++) {
			var r = data[i * 3];
			var g = data[i * 3 + 1];
			var b = data[i * 3 + 2];
		}
	}
</script>
